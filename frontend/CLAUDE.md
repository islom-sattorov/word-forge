# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

**WordForge** is a Telegram Mini App for vocabulary learning, built with React and focusing on learning English words and irregular verbs with gamification features.

## Development Commands

```bash
# Development server (runs on port 5173)
npm run dev

# Build for production
npm run build

# Type checking (TypeScript compilation)
tsc -b

# Linting with Biome
npm run lint

# Format code with Biome
npm run format

# Preview production build
npm run preview
```

## Tech Stack & Architecture

### Core Technologies
- **React 19** with React Compiler enabled (babel-plugin-react-compiler)
- **TypeScript** (strict mode enabled)
- **Vite** using rolldown-vite (alternative bundler)
- **TanStack Router** for file-based routing
- **TanStack Query** for data fetching
- **Zustand** with persist middleware for state management
- **Tailwind CSS v4** for styling
- **i18next** for internationalization
- **Telegram Apps SDK** (@telegram-apps/sdk-react)
- **Biome** for linting and formatting (NOT ESLint/Prettier)

### State Management Architecture

The app uses **Zustand** with **persist middleware** for all state management. Each store is stored in localStorage with specific keys:

1. **userStore** (`wordforge-user`) - User profile and authentication
2. **gamificationStore** (`wordforge-gamification`) - XP, levels, streaks, achievements
3. **customWordsStore** (`wordforge-custom-words`) - User's custom vocabulary
4. **mistakesStore** - Tracks incorrect answers for review
5. **sessionsStore** - Learning session history

All stores use `crypto.randomUUID()` for ID generation.

### Routing Architecture

Uses **file-based routing** with TanStack Router:
- Route files in `src/routes/` automatically generate the route tree
- `src/routeTree.gen.ts` is auto-generated by `@tanstack/router-plugin`
- Root layout in `src/routes/__root.tsx` wraps all routes with `Layout` component
- Never edit `routeTree.gen.ts` manually

### Component Structure

```
src/
├── components/
│   ├── layout/Layout.tsx    # Main layout with bottom navigation
│   └── ui/                  # Reusable UI components (Button, Card, Modal, etc.)
├── pages/                   # Page-level components
├── routes/                  # TanStack Router route files
├── stores/                  # Zustand stores with persist
├── types/index.ts           # All TypeScript type definitions
├── lib/i18n.ts              # Internationalization setup (inline translations)
└── constants/               # Static data (sample words, verbs)
```

### Key Type Definitions

All types are centralized in `src/types/index.ts`:
- `Word` - Vocabulary with difficulty levels (easy/medium/hard)
- `Verb` - Irregular verbs with base/past/participle forms
- `CustomWord` - User-created vocabulary
- `GamificationData` - XP, streaks, achievements, levels
- `Session` - Learning session tracking
- `Mistake` - Incorrect answer tracking

### Styling Approach

- **Tailwind CSS v4** via `@tailwindcss/vite` plugin
- Dark mode support with `dark:` classes
- Mobile-first responsive design
- Bottom navigation for mobile UX (Telegram Mini App pattern)

### Internationalization

- Translations are **inline** in `src/lib/i18n.ts` (no separate JSON files)
- Currently English-only but structured for multi-language expansion
- Use `useTranslation()` hook for accessing translations

### Special Configuration

- **ngrok tunnel** allowed host configured in vite.config.ts for Telegram testing
- **React Compiler** enabled for automatic optimization
- **Strict TypeScript** with unused variables/parameters checking
- **Biome** for code quality (replaces ESLint + Prettier)

## Development Notes

### Adding New Routes
1. Create file in `src/routes/` (e.g., `my-route.tsx`)
2. Export a `Route` object created with `createFileRoute`
3. The route tree auto-generates on dev server restart

### Adding New Store
1. Create store in `src/stores/` following existing patterns
2. Use `create` from zustand with `persist` middleware
3. Choose unique storage key prefixed with `wordforge-`
4. Initialize store in `Layout.tsx` if needed on app start

### Working with Types
All type definitions are in `src/types/index.ts` - update centrally rather than creating inline types.

### Gamification System
- XP calculation: 100 XP per level
- Achievements track progress based on type (streak, words_learned, verbs_learned, accuracy, xp)
- Daily goals and streaks managed through `gamificationStore`
- Streak updates check date differences and reset if more than 1 day gap

### Telegram Mini App Integration
The app uses `@telegram-apps/sdk-react` for Telegram-specific features. Test locally via ngrok tunnel configured in vite.config.ts.
